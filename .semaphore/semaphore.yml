version: v1.0
name: 3decision Quickstart templates upload
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: 3decision templates upload
    task:
      secrets:
        - name: 3dec-quickstart
      jobs:
        - name: 3decision templates upload
          commands:
            - checkout
            - export AWS_ACCESS_KEY_ID=${ACCESS_KEY}
            - export AWS_SECRET_ACCESS_KEY=${SECRET_ACCESS_KEY}
            - sed -i 's/Default: aws-quickstart/Default: 3decision-eu-central-1/g' ~/quickstart-discngine-3decision/templates/*
            - sed -i 's~quickstart-discngine-3decision/~quickstart-discngine-3decision-test/~g' ~/quickstart-discngine-3decision/templates/*
            - aws s3 sync ~/quickstart-discngine-3decision/templates s3://3decision-eu-central-1/quickstart-discngine-3decision-test/templates
